{% extends "Tasks/base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" type="text/css" href="{% static 'Tasks\DataTable\datatables.min.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'Tasks\customDesins.css' %}" />
<div class="mt-2" style="text-align:center;">
    <div class='title-tasks' id="table-title">
        <div>
        <img src="{{ request.user.profile.image.url }}" class="mb-4 rounded-circle article-img">All My Tasks</div>
        </div>
    <a href="{% url 'create-task' %}">
        <button type="button" class="btn btn-dark btn-lg btn-block " id="create-tast-btn-cus" >
            <svg width="1em" height="1em" viewBox="0 0 16 16" class="mr-2 bi bi-plus-circle-fill" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                       <path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4a.5.5 0 0 0-1 0v3.5H4a.5.5 0 0 0 0 1h3.5V12a.5.5 0 0 0 1 0V8.5H12a.5.5 0 0 0 0-1H8.5V4z"/>
                     </svg>Create New Task!
        </button>
    </a>
        <table class="table table-striped mydatatable mr-3 mt-4" style="width:100%;">
            <thead class="thead-dark">
                <tr>
                    <th>Problem</th>
                    <th>Description</th>
                    <th>Start Date</th>
                    <th>Weeks</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>
            </thead>
            <tbody>
            {% for task in tasks %}
            <tr>

                    <td>{{task.problem}}</td>
                    <td>{{task.description}}</td>
                    <td>{{task.start_date}}</td>
                    <td>{{task.weeks }}</td>
                    <td><a href="{% url 'edit-task' task.id %}">
                        <img src="{% static 'Tasks\table_images\edit.png' %}"></a>
                    </td>
                    <td><a href="{% url 'delete-task' task.id %}">
                        <img src="{% static 'Tasks\table_images\delete.png' %}"></a>
                    </td>
            </tr>
            {% endfor %}
            <tfoot>
                <tr>
                    <th colspan="3" class="text-right">Total weeks of Work:</th>
                    <th colspan="1"></th>
                </tr>
            </tfoot>
        </table>
</div>

    <script src="{% static 'blog\JQuery\jquery-3.5.1.slim.min.js' %}"></script>

<script type="text/javascript" src="{% static 'Tasks\DataTable\datatables.min.js' %}"></script>


<script>
    $('.mydatatable').DataTable({
        footerCallback: function (row, data, start, end, display) {
            var api = this.api(), data;

            var intVal = function (i) {
                return typeof i === 'string' ?
                    i.replace(/[\$,]/g, '') * 1 :
                    typeof i === 'number' ?
                        i : 0;
            };
            total = api
                .column(3)
                .data()
                .reduce(function (a, b) {
                    return intVal(a) + intVal(b);
                }, 0);

            $( api.column(3).footer()).html(total);
        }
    });

</script>
{% endblock content %}